<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FastLink - Shortener & Monetize</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .tooltip {
            position: relative;
            display: inline-block;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 120px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -60px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        .slide-up {
            animation: slideUp 0.5s ease-out;
        }
        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen">
    <!-- Header -->
    <header class="bg-gray-800 shadow-lg sticky top-0 z-10">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <i class="fas fa-bolt text-yellow-400 text-2xl"></i>
                <h1 class="text-xl md:text-2xl font-bold">Fast<span class="text-yellow-400">Link</span></h1>
            </div>
            <nav>
                <ul class="flex space-x-6">
                    <li><a href="#" class="hover:text-yellow-400 transition">Beranda</a></li>
                    <li><a href="#" class="hover:text-yellow-400 transition">Riwayat</a></li>
                    <li><a href="#" class="hover:text-yellow-400 transition">Statistik</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8 flex-grow">
        <!-- Shorten Section -->
        <section id="shortenSection" class="max-w-3xl mx-auto bg-gray-800 rounded-xl shadow-xl p-6 md:p-8 mb-8 slide-up">
            <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center">
                <i class="fas fa-link mr-2"></i> Buat Link Keren Sekejap!
            </h2>
            
            <div class="space-y-6">
                <div>
                    <div class="flex items-center mb-2">
                        <label for="originalUrl" class="block text-sm font-medium">Taro Link Panjangmu di Sini</label>
                        <span class="ml-2 text-xs text-gray-400">(URL harus pake http/https)</span>
                    </div>
                    <input type="url" id="originalUrl" required 
                        class="w-full px-4 py-3 rounded-lg bg-gray-700 border border-gray-600 focus:ring-2 focus:ring-yellow-400 focus:border-yellow-500"
                        placeholder="Contoh: https://website.com/halaman-super-panjang-sekali">
                </div>
                
                <div class="flex items-center justify-between">
                    <button id="generateBtn" class="btn-action bg-yellow-500 hover:bg-yellow-600 text-gray-900 font-bold py-3 px-6 rounded-lg flex items-center">
                        <i class="fas fa-magic mr-2"></i> Generate Sekarang
                    </button>
                    
                    <div class="flex items-center space-x-2">
                        <input type="checkbox" id="customToggle" class="h-5 w-5 text-yellow-500 rounded">
                        <label for="customToggle" class="text-sm">Custom Link</label>
                    </div>
                </div>
                
                <div id="customUrlContainer" class="hidden">
                    <label for="customSlug" class="block text-sm font-medium mb-1">Custom Link Kamu</label>
                    <div class="flex">
                        <span class="inline-flex items-center px-4 rounded-l-lg bg-gray-700 border border-r-0 border-gray-600 text-gray-300">
                            github.io/
                        </span>
                        <input type="text" id="customSlug" 
                            class="flex-1 min-w-0 block w-full px-4 py-3 rounded-r-lg bg-gray-700 border border-l-0 border-gray-600 focus:ring-2 focus:ring-yellow-500 focus:border-yellow-400"
                            placeholder="nama-kamu">
                    </div>
                    <p class="text-xs text-gray-400 mt-1">* Hanya huruf (a-z), angka (0-9), dan strip (-)</p>
                </div>
            </div>
            
            <!-- Result Section -->
            <div id="resultSection" class="hidden mt-6 p-4 bg-gray-700 rounded-lg border border-yellow-400 border-dashed fade-in">
                <div class="flex items-center justify-between mb-2">
                    <p class="text-sm text-yellow-400 font-medium">
                        <i class="fas fa-check-circle mr-1"></i> Mantap! Link siap dipake
                    </p>
                    <div class="flex space-x-2">
                        <button id="copyBtn" class="btn-action bg-gray-600 hover:bg-gray-500 text-sm py-1 px-3 rounded">
                            <i class="far fa-copy mr-1"></i> Salin
                        </button>
                    </div>
                </div>
                
                <div class="flex">
                    <input type="text" id="shortUrl" readonly 
                        class="flex-1 px-4 py-2 rounded-l-lg bg-gray-800 border border-gray-600">
                    <button id="qrBtn" class="btn-action bg-gray-600 hover:bg-gray-500 px-3 rounded-r-lg border-l-0 border-gray-600 tooltip">
                        <i class="fas fa-qrcode"></i>
                        <span class="tooltiptext">Generate QR</span>
                    </button>
                </div>
                
                <div class="mt-3 flex items-center">
                    <i class="fas fa-info-circle text-yellow-400 mr-2"></i>
                    <p class="text-xs text-gray-400">Link aktif selama 30 hari â€¢ <a href="#" class="hover:underline">Lihat statistik</a></p>
                </div>
            </div>
        </section>

        <!-- Redirect Section (Hidden Initially) -->
        <section id="redirectSection" class="max-w-3xl mx-auto bg-gray-800 rounded-xl shadow-xl p-6 md:p-8 hidden">
            <div class="text-center mb-8">
                <h2 class="text-2xl md:text-3xl font-bold mb-2">Sebentar Lagi Bro...</h2>
                <p class="text-gray-400">Link kamu akan dibuka dalam <span id="countdown" class="text-yellow-400 font-bold text-xl">5</span> detik</p>
            </div>
            
            <div class="grid md:grid-cols-2 gap-6 mb-8">
                <!-- Ad Banner (Left) -->
                <div class="bg-gray-700 rounded-lg p-4">
                    <p class="text-center text-xs text-gray-400 mb-2">- Iklan Sponsor -</p>
                    <div id="adLeft" class="min-h-[250px] flex items-center justify-center bg-gray-600 rounded">
                        <p class="text-gray-400 text-sm">[AD SPACE 1]</p>
                    </div>
                </div>
                
                <!-- Ad Banner (Right) -->
                <div class="bg-gray-700 rounded-lg p-4">
                    <p class="text-center text-xs text-gray-400 mb-2">- Iklan Sponsor -</p>
                    <div id="adRight" class="min-h-[250px] flex items-center justify-center bg-gray-600 rounded">
                        <p class="text-gray-400 text-sm">[AD SPACE 2]</p>
                    </div>
                </div>
            </div>
            
            <div class="text-center">
                <p class="text-gray-400 mb-4">Makasih udah ngeklik iklan sponsor kita!</p>
                <button id="skipBtn" class="btn-action bg-yellow-500 hover:bg-yellow-600 text-gray-900 font-bold py-3 px-6 rounded-lg inline-flex items-center">
                    <i class="fas fa-forward mr-2"></i> Skip Ads & Lanjutkan
                </button>
            </div>
            
            <div class="mt-8 pt-6 border-t border-gray-700">
                <div class="flex items-center justify-center">
                    <i class="fas fa-shield-alt text-yellow-400 mr-2"></i>
                    <p class="text-sm text-gray-400">Kamu akan dibawa ke: <span id="destinationUrl" class="text-gray-300 underline break-all"></span></p>
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 py-6 mt-12">
        <div class="container mx-auto px-4 text-center">
            <p class="text-sm">
                &copy; 2023 FastLink - Shortener & Monetize
            </p>
            <p class="text-xs text-gray-500 mt-2">
                Dibuat dengan <i class="fas fa-heart text-red-400"></i> untuk memudahkan berbagi link
            </p>
        </div>
    </footer>

    <!-- JavaScript Logic -->
    <script>
        // DOM Elements
        const shortenSection = document.getElementById('shortenSection');
        const redirectSection = document.getElementById('redirectSection');
        const originalUrlInput = document.getElementById('originalUrl');
        const customToggle = document.getElementById('customToggle');
        const customUrlContainer = document.getElementById('customUrlContainer');
        const generateBtn = document.getElementById('generateBtn');
        const resultSection = document.getElementById('resultSection');
        const shortUrlOutput = document.getElementById('shortUrl');
        const copyBtn = document.getElementById('copyBtn');
        const qrBtn = document.getElementById('qrBtn');
        const countdownDisplay = document.getElementById('countdown');
        const skipBtn = document.getElementById('skipBtn');
        const destinationUrl = document.getElementById('destinationUrl');
        const adLeft = document.getElementById('adLeft');
        const adRight = document.getElementById('adRight');

        // Toggle Custom URL
        customToggle.addEventListener('change', () => {
            customUrlContainer.classList.toggle('hidden', !customToggle.checked);
        });

        // Generate Short Link
        generateBtn.addEventListener('click', () => {
            const originalUrl = originalUrlInput.value.trim();
            
            if (!originalUrl) {
                showAlert('Waduh, linknya belum diisi bro!', 'error');
                return;
            }
            
            if (!isValidUrl(originalUrl)) {
                showAlert('Linknya kurang valid nih, coba cek lagi!', 'error');
                return;
            }
            
            // Generate short slug
            let slug;
            if (customToggle.checked) {
                slug = document.getElementById('customSlug').value.trim();
                if (!slug) {
                    showAlert('Woi, custom linknya masih kosong tuh!', 'error');
                    return;
                }
                if (!/^[a-zA-Z0-9-]+$/.test(slug)) {
                    showAlert('Custom link cuma boleh huruf, angka, dan strip (-) aja bro!', 'error');
                    return;
                }
            } else {
                // Generate random 6-char slug
                slug = Math.random().toString(36).substring(2, 8);
            }
            
            // Simpan ke localStorage sebagai riwayat
            const linkData = {
                originalUrl,
                shortUrl: `https://fastlink.id/${slug}`,
                createdAt: new Date().toISOString()
            };
            
            saveLinkToHistory(linkData);
            
            // Tampilkan hasil
            shortUrlOutput.value = linkData.shortUrl;
            resultSection.classList.remove('hidden');
            
            // Scroll ke hasil
            resultSection.scrollIntoView({ behavior: 'smooth' });
            
            showAlert('Yoi! Link udah siap nih', 'success');
        });

        // Copy to Clipboard
        copyBtn.addEventListener('click', () => {
            shortUrlOutput.select();
            document.execCommand('copy');
            
            // Update button state
            copyBtn.innerHTML = '<i class="fas fa-check mr-1"></i> Tersalin!';
            copyBtn.classList.remove('bg-gray-600', 'hover:bg-gray-500');
            copyBtn.classList.add('bg-green-600', 'hover:bg-green-500');
            
            setTimeout(() => {
                copyBtn.innerHTML = '<i class="far fa-copy mr-1"></i> Salin';
                copyBtn.classList.remove('bg-green-600', 'hover:bg-green-500');
                copyBtn.classList.add('bg-gray-600', 'hover:bg-gray-500');
            }, 2000);
        });

        // Generate QR Code
        qrBtn.addEventListener('click', () => {
            // Simulasi generate QR
            showAlert('Fitur QR Code bakal muncul di versi premium bro!', 'info');
        });

        // Skip Button
        skipBtn.addEventListener('click', () => {
            redirectToDestination();
        });

        // Fungsi untuk validasi URL
        function isValidUrl(string) {
            try {
                new URL(string);
                return true;
            } catch (_) {
                return false;
            }
        }

        // Fungsi untuk menyimpan riwayat link
        function saveLinkToHistory(linkData) {
            let linkHistory = JSON.parse(localStorage.getItem('linkHistory') || '[]');
            linkHistory.unshift(linkData); // Add to beginning
            localStorage.setItem('linkHistory', JSON.stringify(linkHistory));
        }

        // Fungsi untuk menampilkan notifikasi
        function showAlert(message, type = 'info') {
            // Implementasi notifikasi bisa menggunakan Toast library
            // Ini hanya simulasi untuk demo
            console.log(`${type.toUpperCase()}: ${message}`);
        }

        // Fungsi untuk memulai redirect
        function startRedirect(destination) {
            // Simpan data link yang akan di-redirect
            sessionStorage.setItem('redirectData', JSON.stringify({
                destination,
                timestamp: new Date().getTime()
            }));
            
            // Tampilkan halaman redirect
            shortenSection.classList.add('hidden');
            redirectSection.classList.remove('hidden');
            destinationUrl.textContent = destination;
            
            // Mulai countdown
            let count = 5;
            countdownDisplay.textContent = count;
            
            const timer = setInterval(() => {
                count--;
                countdownDisplay.textContent = count;
                
                if (count <= 0) {
                    clearInterval(timer);
                    redirectToDestination();
                }
            }, 1000);
        }

        // Fungsi untuk redirect ke tujuan
        function redirectToDestination() {
            const redirectData = JSON.parse(sessionStorage.getItem('redirectData'));
            if (redirectData && redirectData.destination) {
                window.location.href = redirectData.destination;
            }
        }

        // Cek jika ada parameter redirect di URL
        window.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const slug = urlParams.get('r');
            
            if (slug) {
                // Ini simulasi - di real app akan cek ke database
                const mockLinks = {
                    'contoh': 'https://example.com',
                    'test': 'https://google.com'
                };
                
                if (mockLinks[slug]) {
                    startRedirect(mockLinks[slug]);
                } else {
                    showAlert('Waduh, linknya nggak ketemu bro!', 'error');
                }
            }
        });

        // Simulasi generate iklan (bisa diganti dengan kode AdSense)
        function generateAds() {
            const ads = [
                {
                    title: "Diskon 50% Hari Ini",
                    desc: "Buruan belanja sebelum kehabisan!",
                    bg: "bg-gradient-to-r from-purple-500 to-indigo-600"
                },
                {
                    title: "Game Terbaru Rilis",
                    desc: "Mainkan sekarang dapat hadiah!",
                    bg: "bg-gradient-to-r from-green-500 to-teal-600"
                }
            ];
            
            adLeft.innerHTML = createAdHtml(ads[0]);
            adRight.innerHTML = createAdHtml(ads[1]);
        }

        // Helper untuk membuat HTML iklan
        function createAdHtml(ad) {
            return `
                <div class="${ad.bg} rounded-lg p-4 text-white h-full flex flex-col justify-center">
                    <h3 class="text-xl font-bold mb-2">${ad.title}</h3>
                    <p class="text-sm mb-4">${ad.desc}</p>
                    <button class="mt-auto bg-white text-gray-800 py-2 px-4 rounded-lg text-sm font-medium self-center">
                        Klik Disini
                    </button>
                </div>
            `;
        }

        // Generate iklan saat halaman dimuat
        generateAds();
    </script>
</body>
</html>
